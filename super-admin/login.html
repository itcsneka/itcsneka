<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>IT CLUB SNEKA — Login</title>
    <link rel="icon" type="image/png" href="https://files.catbox.moe/brcvv3.png">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#fff;--text:#0f172a;--muted:#64748b;--accent:#0ea5a4;--card:#f8fafc}
    *{box-sizing:border-box}body{margin:0;font-family:"Inter",sans-serif;background:var(--bg);color:var(--text);display:flex;min-height:100vh;align-items:center;justify-content:center}
    .card{background:var(--card);padding:28px;border-radius:12px;max-width:420px;width:100%;box-shadow:0 10px 30px rgba(2,6,23,0.06)}
    label{display:block;margin-bottom:6px;font-weight:600}
    input{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(15,23,42,0.06);margin-bottom:12px}
    .btn{background:var(--accent);color:white;padding:10px 14px;border-radius:10px;border:none;cursor:pointer;width:100%}
    .muted{color:var(--muted);font-size:14px;text-align:center;margin-top:12px}
    .h2masuk{margin:0 0 8px}
  </style>
</head>
<body>
  <div class="card">
    <h2 class="h2masuk">Masuk</h2>
    <p class="muted">Gunakan akun anda untuk masuk</p>

    <form id="loginForm">
      <label for="u">Username</label>
      <input id="u" name="u" placeholder="username" required>
      <label for="p">Password</label>
      <input id="p" name="p" type="password" placeholder="••••••" required>
      <button class="btn" type="submit">Masuk</button>
    </form>

    <div id="msg" class="muted"></div>
  </div>

<script>
  const SHEET_URL = "https://script.google.com/macros/s/AKfycbwQrxgFezgkVdTPjGePvdhD7caJqVGZQBHYlsbTqtslIgJ2xMUApqyo1Z2hI6vZa0fh/exec"; // GANTI URL

  const form = document.getElementById('loginForm');
  const msg = document.getElementById('msg');

  form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    msg.textContent = 'Memeriksa akun...';

    const username = form.u.value.trim();
    const password = form.p.value.trim();

    if(!username || !password){
      msg.textContent = 'Masukkan username & password.';
      return;
    }

    try {
      const res = await fetch(SHEET_URL, {cache: 'no-store'});
      if(!res.ok) throw new Error('Gagal ambil data dari sheet');

      const users = await res.json();
      if(!Array.isArray(users)) throw new Error('Format sheet tidak valid');

      const found = users.find(u =>
        String(u.username || '').toLowerCase() === username.toLowerCase() &&
        String(u.password || '') === password
      );

      if(found){
        localStorage.setItem('itc-user', found.username);
        msg.textContent = 'Login berhasil. Mengalihkan...';
        setTimeout(()=> location.href = 'admin-pages/admin.html', 600);
      } else {
        msg.textContent = 'Username atau password salah.';
      }
    } catch(err){
      console.error(err);
      msg.textContent = 'Tidak dapat menghubungi server. Coba lagi.';
    }
  });
</script>

</body>
</html>
